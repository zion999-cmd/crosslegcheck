# STM32H750嵌入式模型评估报告

## 📊 测试结果总结

### 模型性能对比 (测试集393样本)

| 模型类型 | 准确率 | 模型大小 | 预测时间 | STM32适用性 | 推荐度 |
|---------|-------|----------|----------|-------------|--------|
| KNN-3 | **77.1%** | 715.4KB | 77.15ms | ❌ 不适用 | ⭐ |
| KNN-5 | 76.6% | 715.4KB | 36.54ms | ❌ 不适用 | ⭐ |
| Logistic回归 | 66.2% | **0.3KB** | **0.36ms** | ✅ 极佳 | ⭐⭐⭐⭐⭐ |
| 随机森林 | 64.4% | 11.4KB | 2.06ms | ✅ 良好 | ⭐⭐⭐⭐ |
| 决策树 | 57.0% | **1.8KB** | **0.47ms** | ✅ 优秀 | ⭐⭐⭐ |

## 🎯 STM32H750推荐方案

### 方案1: Logistic回归 (最推荐)
- **准确率**: 66.2%
- **模型大小**: 仅0.3KB (24个特征 × 3个类别的权重矩阵)
- **预测速度**: 0.36ms (极快)
- **内存需求**: 非常低
- **计算复杂度**: 简单的矩阵乘法
- **实现难度**: 容易

**STM32实现要点**:
```c
// 只需要24个权重和3个偏置
float weights[24][3];
float bias[3];

// 预测函数
int predict(float features[24]) {
    float scores[3] = {0};
    for(int i = 0; i < 24; i++) {
        for(int j = 0; j < 3; j++) {
            scores[j] += features[i] * weights[i][j];
        }
    }
    for(int j = 0; j < 3; j++) {
        scores[j] += bias[j];
    }
    return argmax(scores);
}
```

### 方案2: 决策树 (备选)
- **准确率**: 57.0%
- **模型大小**: 1.8KB
- **预测速度**: 0.47ms
- **特点**: 可解释性强，无需浮点运算

### 方案3: 混合方案 (创新)
结合两个模型的优势：
1. 先用决策树快速筛选明显的情况
2. 对于边界情况使用Logistic回归精确判断

## 🔧 特征工程评估

### 当前特征集 (24维)
1. **统计特征** (8维): 均值、标准差、最值、中位数等
2. **空间特征** (8维): 重心位置、区域压力分布、对称性
3. **峰值特征** (4维): 峰值相关统计

### 特征提取性能
- **原始维度**: 256维 → **压缩后**: 24维 (压缩比 10.7:1)
- **特征提取时间**: 约1-2ms (估算)
- **内存需求**: 24个float (96字节)

## ⚠️ 性能问题分析

### 准确率相对较低的原因
1. **特征压缩损失**: 256维→24维压缩过度
2. **测试集差异**: 可能存在域偏移
3. **特征质量**: 当前特征可能不够discriminative

### 改进建议
1. **增加关键特征**:
   - 边缘检测特征
   - 纹理特征
   - 时序特征(如果有连续帧)

2. **优化特征选择**:
   - 使用特征重要性分析
   - 相关性分析去除冗余特征

3. **数据预处理**:
   - 标准化压力值范围
   - 噪声过滤

## 🚀 STM32H750部署建议

### 硬件配置
- **Flash**: 2MB (模型<1KB，绰绰有余)
- **RAM**: 1MB (特征存储<1KB)
- **CPU**: 400MHz Cortex-M7 (浮点计算能力强)

### 实时性能预估
- **传感器读取**: ~1ms
- **特征提取**: ~2ms
- **模型推理**: ~0.5ms
- **总延迟**: ~3.5ms (满足实时要求)

### 开发路径
1. **第一阶段**: 实现Logistic回归模型
2. **第二阶段**: 优化特征提取算法
3. **第三阶段**: 添加决策树作为备选
4. **第四阶段**: 实现混合预测策略

## 📈 与CNN模型对比

| 指标 | CNN模型 | Logistic回归 | 优势 |
|------|---------|-------------|------|
| 准确率 | 99.9%(训练) | 66.2%(测试) | CNN更准确 |
| 模型大小 | 143KB | 0.3KB | **轻量化477倍** |
| 推理时间 | ~10ms | 0.36ms | **速度快28倍** |
| 内存需求 | 高 | 极低 | **内存友好** |
| 功耗 | 高 | 低 | **低功耗** |
| 部署难度 | 困难 | 简单 | **易部署** |

## 🎯 结论

对于STM32H750嵌入式部署：

1. **Logistic回归是最佳选择** - 虽然准确率不如CNN，但在资源约束下是最实用的方案
2. **66.2%的准确率在嵌入式场景下是可接受的** - 可以通过多帧平均、阈值调整等方式提升
3. **极低的资源需求** - 适合实时、低功耗应用
4. **快速部署** - 相比CNN移植，实现周期短

## 🔄 下一步计划

1. **生成C代码** - 为STM32H750生成完整的C实现
2. **特征优化** - 改进特征提取算法提升准确率
3. **硬件测试** - 在实际STM32H750上验证性能
4. **系统集成** - 整合到完整的坐姿检测系统

---

**总体评价**: 轻量级模型在准确率和资源需求间取得了合理的平衡，为STM32嵌入式部署提供了可行方案。